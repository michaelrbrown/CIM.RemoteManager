<pages:BasePage Title="Sensors"
                x:Class="CIM.RemoteManager.Core.Pages.SensorListPage"
                xmlns="http://xamarin.com/schemas/2014/forms" xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                xmlns:dataSource="clr-namespace:Syncfusion.DataSource;assembly=Syncfusion.DataSource.Portable" xmlns:pages="clr-namespace:CIM.RemoteManager.Core.Pages;assembly=CIM.RemoteManager.Core" xmlns:syncfusion="clr-namespace:Syncfusion.ListView.XForms;assembly=Syncfusion.SfListView.XForms"
                xmlns:templates="clr-namespace:CIM.RemoteManager.Core.Templates;assembly=CIM.RemoteManager.Core"
                Padding="0"
                BackgroundColor="#FFFFFF">

    <!-- Background -->
    <Image Aspect="AspectFill" IsVisible="False" RelativeLayout.HeightConstraint="{ConstraintExpression Type=RelativeToParent, Property=Height}" RelativeLayout.WidthConstraint="{ConstraintExpression Type=RelativeToParent, Property=Width}" Source="bg_app.jpg" />

    <StackLayout Padding="10" HorizontalOptions="CenterAndExpand" BackgroundColor="#AE2C3B" IsVisible="{Binding IsStateOn, Converter={StaticResource BooleanToFalseConverter}}">
        <Grid HorizontalOptions="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Image VerticalOptions="Center" HorizontalOptions="End" Source="bluetooth-info.png" />
            <Label Grid.Column="1" VerticalOptions="Center" FontSize="18" Text="{Binding StateText}" TextColor="#FFFFFF" />
        </Grid>
    </StackLayout>

    <!-- Sensor ListView -->
    <syncfusion:SfListView x:Name="SensorLiistView"
                           Margin="0"
                           AllowSwiping="False" HeaderSize="40" IsStickyFooter="True" IsStickyGroupHeader="False" ItemDoubleTapped="SensorListView_OnItemDoubleTapped"
                           ItemSize="116" ItemSpacing="0"
                           ItemsSource="{Binding SensorCollection}"
                           SelectionBackgroundColor="Transparent">

        <!-- Sensor ListView Group DataSource -->
        <syncfusion:SfListView.DataSource>
            <dataSource:DataSource>
                <dataSource:DataSource.GroupDescriptors>
                    <dataSource:GroupDescriptor PropertyName="SensorTypeGroup" />
                </dataSource:DataSource.GroupDescriptors>
            </dataSource:DataSource>
        </syncfusion:SfListView.DataSource>

        <!-- Layout Manager (provides columns on higher resolution devices) -->
        <syncfusion:SfListView.LayoutManager>
            <syncfusion:GridLayout>
                <syncfusion:GridLayout.SpanCount>
                    <OnPlatform x:TypeArguments="x:Int32">
                        <OnPlatform.Android>
                            <OnIdiom x:TypeArguments="x:Int32" Phone="1" Tablet="2" />
                        </OnPlatform.Android>
                        <OnPlatform.iOS>
                            <OnIdiom x:TypeArguments="x:Int32" Phone="1" Tablet="2" />
                        </OnPlatform.iOS>
                    </OnPlatform>
                </syncfusion:GridLayout.SpanCount>
            </syncfusion:GridLayout>
        </syncfusion:SfListView.LayoutManager>

        <!-- Sensor ListView Header Template -->
        <syncfusion:SfListView.HeaderTemplate>
            <DataTemplate>
                <StackLayout VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand"
                             BackgroundColor="{StaticResource RemoteNameBackgroundColor}"
                             HeightRequest="40" Orientation="Horizontal" Spacing="0">
                    <Label VerticalOptions="Center" HorizontalOptions="CenterAndExpand" FontSize="20" Text="{Binding DeviceName}" TextColor="{StaticResource HeaderTextColor}" />
                </StackLayout>
            </DataTemplate>
        </syncfusion:SfListView.HeaderTemplate>

        <!-- Sensor ListView Group Template -->
        <syncfusion:SfListView.GroupHeaderTemplate>
            <DataTemplate>
                <ViewCell>
                    <ViewCell.View>
                        <StackLayout Margin="0" Padding="15"
                                     VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand"
                                     BackgroundColor="{StaticResource GroupBackgroundColor}"
                                     Orientation="Horizontal">


                            <!-- Margin: left, top, right, bottom -->
                            <Image Aspect="AspectFit" Scale="1" Source="{Binding SensorImage}" />
                            <!-- Margin: left, top, right, bottom -->
                            <Label Margin="0,5,0,5"
                                   VerticalOptions="Center" HorizontalOptions="CenterAndExpand"
                                   FontAttributes="Italic" FontSize="20" HorizontalTextAlignment="Center"
                                   Text="{Binding Key}"
                                   TextColor="#FFFFFF" VerticalTextAlignment="Center" WidthRequest="225" />
                        </StackLayout>
                    </ViewCell.View>
                </ViewCell>
            </DataTemplate>
        </syncfusion:SfListView.GroupHeaderTemplate>

        <!-- Sensor ListView Item Template -->
        <syncfusion:SfListView.ItemTemplate>
            <DataTemplate>
                <ViewCell>
                    <!-- Sensor Detail Template -->
                    <templates:SensorItemTemplate />
                </ViewCell>
            </DataTemplate>
        </syncfusion:SfListView.ItemTemplate>

        <syncfusion:SfListView.RightSwipeTemplate>
            <DataTemplate x:Name="RightSwipeTemplate">
                <Grid VerticalOptions="Fill" HorizontalOptions="Fill" BackgroundColor="{StaticResource RemoteNameBackgroundColor}">
                    <Grid VerticalOptions="Center" HorizontalOptions="Center">
                        <Image Grid.Row="0" Grid.Column="0"
                               BackgroundColor="Transparent" HeightRequest="48" Source="ic_sensor-settings.png" WidthRequest="48" />
                    </Grid>
                </Grid>
            </DataTemplate>
        </syncfusion:SfListView.RightSwipeTemplate>

        <!-- Sensor ListView Footer Template -->
        <syncfusion:SfListView.FooterTemplate>
            <DataTemplate>
                <!-- Margin: left, top, right, bottom -->
                <StackLayout VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand"
                             BackgroundColor="{StaticResource RemoteNameBackgroundColor}"
                             HeightRequest="60" Opacity=".6" Orientation="Horizontal" Spacing="0">
                    <Label Margin="5"
                           VerticalOptions="CenterAndExpand" HorizontalOptions="StartAndExpand"
                           FontSize="16" LineBreakMode="MiddleTruncation"
                           Text="{Binding CharacteristicValue, StringFormat=' Incoming Value: {0:N}'}"
                           TextColor="{StaticResource AppLightColor}"
                           VerticalTextAlignment="Center" />
                </StackLayout>
            </DataTemplate>
        </syncfusion:SfListView.FooterTemplate>

    </syncfusion:SfListView>

</pages:BasePage>